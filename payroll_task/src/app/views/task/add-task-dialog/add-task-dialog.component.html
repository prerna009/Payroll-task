<div>
    <h2 mat-dialog-title class="border-bottom">
        {{data.Action}} Task
    </h2>
    <mat-tab-group [(selectedIndex)]="selectedIndex" (selectedTabChange)="onTabChange()">
        <mat-tab [disabled]="data.Action !== 'Add' && !tabDisable">
            <ng-template matTabLabel>
                Assign To Others
            </ng-template>
            <ng-template matTabContent>
                <form class="form" [formGroup]="addTaskForm">
                    <div class="row form-group p-10">
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput type="text" placeholder="Title" formControlName="Title" />
                                <mat-error>
                                    Title is required.
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field>
                                <input matInput type="text" placeholder="Description" formControlName="Description" />
                                <mat-error>
                                    Description is required.
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-12">
                            <mat-form-field class="mat-form-field-fluid">
                                <input class="kt-pointer" matInput placeholder="Attach File" [value]="displayFileName"
                                    (click)="triggerFileSelect()" readonly />
                                <input type="text" formControlName="Image" hidden />
                            </mat-form-field>
                            <input #fileInput type="file" (change)="triggerFileSelect($event)" hidden />

                            <div class="kt-remove-input-value" *ngIf="displayFileName" (click)="removeFile()">
                                Remove
                            </div>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="mat-form-field-fluid">
                                <mat-select formControlName="LeadId" placeholder="Lead/ Customer Name">
                                    <mat-option>
                                        <ngx-mat-select-search [formControl]="searchText" placeholderLabel="Search"
                                            noEntriesFoundLabel="No records found"></ngx-mat-select-search>
                                    </mat-option>
                                    <mat-option *ngFor="let lead of leadFilter" [value]="lead.Id">
                                        {{lead.LeadName}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="mat-form-field-fluid">
                                <input matInput [matDatepicker]="picker" placeholder="Select Due Date" [min]="current"
                                    formControlName="TaskEndDateDisplay" readonly />
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                                <mat-error>Please enter Due Date</mat-error>
                                <!-- <input matInput formControlName="TaskEndDate" hidden /> -->
                            </mat-form-field>
                        </div>
                          
                        <div class="col-md-6">
                            <mat-form-field class="mat-form-field-fluid">
                                <mat-select placeholder="Select Priority" formControlName="Priority">
                                    <mat-option value="High">High Priority</mat-option>
                                    <mat-option value="Low">Low Priority</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="mat-form-field-fluid">
                                <input matInput placeholder="Add Users" formControlName="UserDisplayIds" readonly
                                    (click)="openMembers('UserIds')" />
                                <mat-error>Users is
                                    <strong>required</strong>
                                </mat-error>
                                <input matInput formControlName="UserIds" hidden />
                            </mat-form-field>
                            <div class="kt-remove-input-value" (click)="removeOwners('User')"
                                *ngIf="data.Action === 'Edit' && assignedToCount >= 1">Remove
                            </div>
                        </div>
                    </div>
                </form>
            </ng-template>
        </mat-tab>

        <mat-tab [disabled]="data.Action !== 'Add' && tabDisable">
            <ng-template matTabLabel>
                Assign To Me
            </ng-template>
            <ng-template matTabContent>
                <form class="form" [formGroup]="addTaskForm">
                    <div>
                        <mat-form-field>
                            <input matInput type="text" placeholder="Title" formControlName="Title" />
                            <mat-error>
                                Title is required.
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field>
                            <input matInput type="text" placeholder="Description" formControlName="Description" />
                            <mat-error>
                                Description is required.
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-lg-12 kt-margin-bottom-20-mobile">
                        <mat-form-field class="mat-form-field-fluid">
                            <input class="kt-pointer" matInput placeholder="Attach File" [value]="displayFileName"
                                (click)="triggerFileSelect()" readonly />
                            <input type="text" formControlName="Image" hidden />
                        </mat-form-field>
                        <input #fileInput type="file" (change)="triggerFileSelect($event)" hidden />

                        <div class="kt-remove-input-value" *ngIf="displayFileName" (click)="removeFile()">
                            Remove
                        </div>
                    </div>
                    <div>
                        <mat-form-field class="mat-form-field-fluid">
                            <mat-select formControlName="LeadId" placeholder="Lead/ Customer Name">
                                <mat-option>
                                    <ngx-mat-select-search [formControl]="searchText" placeholderLabel="Search"
                                        noEntriesFoundLabel="No records found"></ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let lead of leadFilter" [value]="lead.Id">
                                    {{lead.LeadName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field class="mat-form-field-fluid">
                            <input matInput [matDatepicker]="picker" placeholder="Select Due Date" [min]="current"
                                formControlName="TaskEndDateDisplay" readonly />
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                            <mat-error>Please enter Due Date</mat-error>
                            <!-- <input matInput formControlName="TaskEndDate" hidden /> -->
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field class="mat-form-field-fluid">
                            <mat-select placeholder="Select Priority" formControlName="Priority">
                                <mat-option value="High">High Priority</mat-option>
                                <mat-option value="Low">Low Priority</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field class="mat-form-field-fluid">
                            <input matInput placeholder="Add CC Members" formControlName="TaskDisplayOwners" readonly
                                (click)="openMembers('TaskOwners')" />
                            <input matInput formControlName="TaskOwners" hidden />
                        </mat-form-field>
                        <div class="kt-remove-input-value" (click)="removeOwners('Owner')"
                            *ngIf="data.Action === 'Edit' && assignedToCount >= 1">Remove
                        </div>
                    </div>
                </form>
            </ng-template>
        </mat-tab>
    </mat-tab-group>
    <mat-dialog-actions>
        <button (click)="onClick()" type="button" mat-raised-button> Cancel</button>&nbsp;
        <button (click)="onSubmit()" type="button" mat-raised-button color="primary" [disabled]="viewLoading">
            {{data.Button}}
        </button>&nbsp;
    </mat-dialog-actions>
</div>